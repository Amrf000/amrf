<link rel="stylesheet" type="text/css" href="../css/blog.css"><div class="cloud-blog-detail-content-wrap the_height"><div class="cloud-blog-detail-content-wrap">
    <div class="cloud-blog-detail-content blog-content-block-0" id="blogContent">
        <p>想实现QOpenglWidget或者QGLWidget的透明效果，发现效果达不到预期，可以透明但是渲染顺序总是在其他普通控件之前.</p><p>后来只能使用QGraphicView代替</p><p>测试代码如下:<br></p><pre style="margin-top:0px;margin-bottom:0px;">class&nbsp;CEasyGLWidget&nbsp;:&nbsp;public&nbsp;QGLWidget</pre><pre style="margin-top:0px;margin-bottom:0px;">{</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;Q_OBJECT</pre><pre style="margin-top:0px;margin-bottom:0px;">public:</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;CEasyGLWidget(&nbsp;const&nbsp;QGLFormat&amp;&nbsp;format,&nbsp;QWidget*&nbsp;parent&nbsp;=&nbsp;0&nbsp;&nbsp;);</pre><pre style="margin-top:0px;margin-bottom:0px;"><br></pre><pre style="margin-top:0px;margin-bottom:0px;">protected:</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;initializeGL();</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;resizeGL(&nbsp;int&nbsp;w,&nbsp;int&nbsp;h&nbsp;);</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;paintGL();</pre><pre style="margin-top:0px;margin-bottom:0px;"><br></pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;keyPressEvent(&nbsp;QKeyEvent*&nbsp;e&nbsp;);</pre><pre style="margin-top:0px;margin-bottom:0px;"><br></pre><pre style="margin-top:0px;margin-bottom:0px;">private:</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;prepareShaderProgram(&nbsp;const&nbsp;QString&amp;&nbsp;vertexShaderPath,</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;QString&amp;&nbsp;geometryShaderPath,</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;QString&amp;&nbsp;fragmentShaderPath&nbsp;);</pre><pre style="margin-top:0px;margin-bottom:0px;"><br></pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;QOpenGLShaderProgram&nbsp;m_shader;</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;QOpenGLBuffer&nbsp;m_vertexBuffer;</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;inited;</pre><pre style="margin-top:0px;margin-bottom:0px;"><br></pre><pre style="margin-top:0px;margin-bottom:0px;">};</pre><pre style="margin-top:0px;margin-bottom:0px;"><br></pre><pre style="margin-top:0px;margin-bottom:0px;"><br></pre><pre style="margin-top:0px;margin-bottom:0px;">class&nbsp;CEasyGraphicsItem&nbsp;:&nbsp;public&nbsp;QGraphicsItem</pre><pre style="margin-top:0px;margin-bottom:0px;">{</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;//Q_OBJECT</pre><pre style="margin-top:0px;margin-bottom:0px;"><br></pre><pre style="margin-top:0px;margin-bottom:0px;">public:</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;CEasyGraphicsItem(QWidget&nbsp;*parent&nbsp;=&nbsp;0);</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;~CEasyGraphicsItem();</pre><pre style="margin-top:0px;margin-bottom:0px;"><br></pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;QRectF&nbsp;boundingRect()&nbsp;const;</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;paint&nbsp;(&nbsp;QPainter&nbsp;*&nbsp;painter,&nbsp;const&nbsp;QStyleOptionGraphicsItem&nbsp;*&nbsp;option,&nbsp;QWidget&nbsp;*&nbsp;widget&nbsp;=&nbsp;0&nbsp;);</pre><pre style="margin-top:0px;margin-bottom:0px;"><br></pre><pre style="margin-top:0px;margin-bottom:0px;">private:</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;CEasyGLWidget&nbsp;*m_OGLItem;</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;QPixmap&nbsp;m_Pixmap;</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;QImage&nbsp;m_Image;</pre><pre style="margin-top:0px;margin-bottom:0px;"><br></pre><pre style="margin-top:0px;margin-bottom:0px;">};</pre><pre style="margin-top:0px;margin-bottom:0px;"><br></pre><pre style="margin-top:0px;margin-bottom:0px;">class&nbsp;Md3View:public&nbsp;QGraphicsView,</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;QOpenGLFunctions</pre><pre style="margin-top:0px;margin-bottom:0px;">{</pre><pre style="margin-top:0px;margin-bottom:0px;">public:</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;Md3View(&nbsp;QWidget*&nbsp;pParent&nbsp;=&nbsp;0&nbsp;);</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;~Md3View(&nbsp;void&nbsp;);</pre><pre style="margin-top:0px;margin-bottom:0px;">private:</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;QGraphicsScene&nbsp;&nbsp;*m_pMainGraphicsScene;</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;//QGraphicsView&nbsp;&nbsp;&nbsp;*m_pMainGraphicsView;</pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;QGLWidget&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*m_pMainGLWidget;</pre><pre style="margin-top:0px;margin-bottom:0px;"><br></pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;CEasyGraphicsItem&nbsp;*m_pItem;</pre><pre style="margin-top:0px;margin-bottom:0px;"><br></pre><pre style="margin-top:0px;margin-bottom:0px;">&nbsp;&nbsp;&nbsp;&nbsp;CEasyGLWidget&nbsp;*m_OGLItem;</pre><pre style="margin-top:0px;margin-bottom:0px;">};</pre><p><br></p>
    </div>
    
    
    <p class="pc_current ask-tip">登录后可下载附件，请<a href="https://auth.huaweicloud.com/authui/login?service=https://bbs.huaweicloud.com/blogs/101926#attachment&amp;locale=zh-cn">登录</a>或者<a href="https://reg.huaweicloud.com/registerui/public/custom/register.html?locale=zh-cn&amp;service=https://bbs.huaweicloud.com#/register">注册</a></p>

    <!-- 版权声明 start -->
    
   
    
    <!-- 版权声明 end -->

    <div class="blog-menu-footer m-blog-menu-footer-bottom">
        
    </div>
</div></div>