<link rel="stylesheet" type="text/css" href="../css/blog.css"><div class="cloud-blog-detail-content-wrap the_height"><div class="cloud-blog-detail-content-wrap">
    <div class="cloud-blog-detail-content blog-content-block-0" id="blogContent">
        <p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">原文：<a rel="nofollow" href="http://shengwangi.blogspot.com/2016/03/netty-tutorial-hello-world-example.html" style="margin:0px;padding:0px;background-color:transparent;color:rgb(45,86,177);font-weight:inherit;">http</a>：<a rel="nofollow" href="http://shengwangi.blogspot.com/2016/03/netty-tutorial-hello-world-example.html" style="margin:0px;padding:0px;background-color:transparent;color:rgb(45,86,177);font-weight:inherit;font-size:16px;font-family:roboto, 'PingFang SC', '微软雅黑', 'Microsoft Yahei', Helvetica, Arial, sans-serif;">//shengwangi.blogspot.com/2016/03/netty-tutorial-hello-world-example.html</a></p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">Netty是一个NIO客户端服务器框架，可以快速轻松地开发网络应用程序。在本教程中，介绍了Netty的基本概念，以及一个hello world level示例。这个基于Netty 4的hello world示例有一个服务器和一个客户端，包括它们之间的心跳，以及POJO发送和接收。</p><h3 style="margin:0px 0px 12px;padding:0px;color:rgb(57,61,70);font-size:22px;font-family:'Open Sans', sans-serif;letter-spacing:-1px;white-space:normal;border:0px;line-height:38px;vertical-align:baseline;background-color:rgb(255,255,255);">1.概念</h3><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">Netty的高性能依赖于NIO。Netty有几个重要的概念：通道，管道和入站/出站处理程序。（</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);"><span style="margin:0px;padding:0px;width:100%;font-family:roboto, 'PingFang SC', '微软雅黑', 'Microsoft Yahei', Helvetica, Arial, sans-serif;font-size:16px;">通道</span>&nbsp;&nbsp;可以被认为是I / O请求将经历的隧道。每个频道都有自己的管道。在API级别，最常用的通道是&nbsp;&nbsp;<em style="margin:0px;padding:0px;font-family:georgia;font-size:inherit;border:0px;font-variant:inherit;font-weight:inherit;line-height:inherit;vertical-align:baseline;">io.netty.channel。<span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;"></span></em>&nbsp;用于套接字服务器和<em style="margin:0px;padding:0px;font-family:georgia;font-size:inherit;border:0px;font-variant:inherit;font-weight:inherit;line-height:inherit;vertical-align:baseline;">io.netty.channel的<span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;"></span></em><em style="margin:0px;padding:0px;font-family:georgia;font-size:inherit;border:0px;font-variant:inherit;font-weight:inherit;line-height:inherit;vertical-align:baseline;"><span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;">NioServerSocketChannel</span></em><em style="margin:0px;padding:0px;font-family:georgia;font-size:inherit;border:0px;font-variant:inherit;font-weight:inherit;line-height:inherit;vertical-align:baseline;">。</em><em style="margin:0px;padding:0px;font-family:georgia;font-size:inherit;border:0px;font-variant:inherit;font-weight:inherit;line-height:inherit;vertical-align:baseline;"><span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;">NioSocketChannel</span></em>&nbsp;&nbsp;用于套接字客户端。</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);"><span style="margin:0px;padding:0px;width:100%;font-family:roboto, 'PingFang SC', '微软雅黑', 'Microsoft Yahei', Helvetica, Arial, sans-serif;font-size:16px;">管道</span>&nbsp;&nbsp;是Netty最重要的概念之一。您可以将管道视为双向队列。队列中填充了入站和出站处理程序。每个处理程序都像servlet过滤器一样工作。顾名思义，&nbsp;&nbsp;<span style="margin:0px;padding:0px;width:100%;font-family:roboto, 'PingFang SC', '微软雅黑', 'Microsoft Yahei', Helvetica, Arial, sans-serif;font-size:16px;">“入站”处理程序</span>&nbsp;&nbsp;只处理读入I / O事件，&nbsp;&nbsp;<span style="margin:0px;padding:0px;width:100%;font-family:roboto, 'PingFang SC', '微软雅黑', 'Microsoft Yahei', Helvetica, Arial, sans-serif;font-size:16px;">“OutBound”处理程序</span>&nbsp;&nbsp;只处理写出I / O事件，&nbsp;&nbsp;<span style="margin:0px;padding:0px;width:100%;font-family:roboto, 'PingFang SC', '微软雅黑', 'Microsoft Yahei', Helvetica, Arial, sans-serif;font-size:16px;">“InOutbound”处理程序</span>&nbsp;&nbsp;处理两者。例如，配置有5个处理程序的管道看起来如下。</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);"><a rel="nofollow" href="https://lh3.googleusercontent.com/-PQnsOHAXQZQ/VvOo3QZwYWI/AAAAAAAAA5Q/WM0F_LFV184/s1600-h/image14.png" style="margin:0px;padding:0px;background-color:transparent;color:rgb(82,111,148);font:inherit;border:0px;vertical-align:baseline;"><img src="https://bbs-img.huaweicloud.com/blogs/img/1561273249765509.png" title="1561273249765509.png" alt="image_thumb4.png" class="localImage"></a></p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">此管道等效于以下逻辑。输入I / O事件由处理程序1-3-4-5处理。输出由handes 5-2处理。</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);"><a rel="nofollow" href="https://lh3.googleusercontent.com/-dk4k-D8Cx0M/VvOo5B8vXnI/AAAAAAAAA5Y/3HyOyuxj_nw/s1600-h/image11.png" style="margin:0px;padding:0px;background-color:transparent;color:rgb(82,111,148);font:inherit;border:0px;vertical-align:baseline;"><img src="https://bbs-img.huaweicloud.com/blogs/img/1561273255412703.png" title="1561273255412703.png" alt="image_thumb3.png" class="localImage"></a></p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">在实际项目中，第一个输入处理程序（上图中的处理程序1）通常是解码器。上图中的最后一个输出处理程序2处理程序通常是编码器。最后一个InOutboundHandler通常执行实际业务，处理输入数据对象并发送回复。&nbsp;<span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;">在实际使用中，最后一个业务逻辑处理程序通常在与I / O线程不同的线程中执行，因此I / O不会被任何耗时的任务阻塞。&nbsp;</span>（见下面的例子）</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);"><span style="margin:0px;padding:0px;width:100%;font-family:roboto, 'PingFang SC', '微软雅黑', 'Microsoft Yahei', Helvetica, Arial, sans-serif;font-size:16px;">解码器</span>&nbsp;&nbsp;将读入的ByteBuf转换为在上面的业务逻辑中使用的数据结构。例如，将字节流传输到POJO。如果没有完全接收到帧，它将一直阻塞直到完成，因此下一个处理程序不需要面对部分帧。</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);"><span style="margin:0px;padding:0px;width:100%;font-family:roboto, 'PingFang SC', '微软雅黑', 'Microsoft Yahei', Helvetica, Arial, sans-serif;font-size:16px;">编码器</span>&nbsp;&nbsp;将内部数据结构传输到最终将由套接字写出的ByteBuf。</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">事件如何流经所有处理程序？需要注意的一点是，&nbsp;&nbsp;<span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;">每个处理程序都可以将事件传播到下一个处理程序</span>。一个处理程序需要显式调用<em style="margin:0px;padding:0px;font-family:georgia;font-size:inherit;border:0px;font-variant:inherit;font-weight:inherit;line-height:inherit;vertical-align:baseline;">ChannelHanderContext</em>的方法&nbsp;&nbsp;&nbsp;来触发下一个处理程序才能工作。那些方法包括：</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">入站事件传播方法：</p><ul class="list-paddingleft-2" style="list-style-type:circle;"><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.fireChannelRegistered（）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.fireChannelActive（）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.fireChannelRead（对象）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.fireChannelReadComplete（）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.fireExceptionCaught（的Throwable）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.fireUserEventTriggered（对象）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.fireChannelWritabilityChanged（）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.fireChannelInactive（）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.fireChannelUnregistered（）</p></li></ul><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">出站事件传播方法：</p><ul class="list-paddingleft-2" style="list-style-type:circle;"><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.bind（SocketAddress，ChannelPromise）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.connect（SocketAddress，SocketAddress，ChannelPromise）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.write（Object，ChannelPromise）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.flush（）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.read（）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.disconnect（ChannelPromise）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.close（ChannelPromise）</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">ChannelHandlerContext.deregister（ChannelPromise）</p></li></ul><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">本文中的演示使用在客户端和服务器之间设置心跳以保持长连接。Netty的&nbsp;&nbsp;<span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;">IdleStateHandler&nbsp;</span>用于空闲时的心跳。在此&nbsp;&nbsp;<span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;">IdleStateHandler中，&nbsp;</span>&nbsp;&nbsp;调用<em style="margin:0px;padding:0px;font-family:georgia;font-size:inherit;border:0px;font-variant:inherit;font-weight:inherit;line-height:inherit;vertical-align:baseline;">fireUserEventTriggered（）</em>以触发下一个处理程序的操作。</p><h2 style="margin:0px 0px 12px;padding:0px;color:rgb(57,61,70);font-size:24px;font-family:'Open Sans', sans-serif;letter-spacing:-1px;white-space:normal;border:0px;line-height:40px;vertical-align:baseline;background-color:rgb(255,255,255);">2.使用Netty 4的Hello world示例</h2><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">此示例有1个服务器和1个客户端。长连接用于数据传输。如果每5秒钟之间没有数据，则会从服务器向客户端发送心跳消息。心跳消息具有发送时间的时间戳。当心跳加速时，客户端什么都不做，只需将其发送回服务器即可。服务器可以通过发送时间使用recv time substract打印出环回延迟。</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">此示例显示：</p><ul class="list-paddingleft-2" style="list-style-type:circle;"><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">如何在编码器/解码器的帮助下发送/ recv POJO</p></li><li><p style="color:rgb(37,43,58);font-weight:inherit;margin-top:0px;margin-bottom:0px;padding:0px;font-size:14px;line-height:22px;">如何为长连接添加心跳。</p></li></ul><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">演示服务器的管道如下所示。</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);"><a rel="nofollow" href="https://lh3.googleusercontent.com/-Wu4VhEQXKk0/VvOo7GY1v8I/AAAAAAAAA5g/37dI9GEinqY/s1600-h/image20.png" style="margin:0px;padding:0px;background-color:transparent;color:rgb(82,111,148);font:inherit;border:0px;vertical-align:baseline;"><img src="https://bbs-img.huaweicloud.com/blogs/img/1561273263373989.png" title="1561273263373989.png" alt="image_thumb6.png" class="localImage"></a></p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">IdleStateHandler位于最开头，因此即使输入流量处于错误的帧格式，它也可以判断是否存在流量。&nbsp;</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">演示客户端的管道如下所示。</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);"><a rel="nofollow" href="https://lh3.googleusercontent.com/-LvzqFkuGJuc/VvOo9H9yf1I/AAAAAAAAA5o/Rc2TwG3CBrY/s1600-h/image2.png" style="margin:0px;padding:0px;background-color:transparent;color:rgb(82,111,148);font:inherit;border:0px;vertical-align:baseline;"><img src="https://bbs-img.huaweicloud.com/blogs/img/1561273268942520.png" title="1561273268942520.png" alt="image_thumb.png" class="localImage"></a></p><h4 style="margin:0px 0px 12px;padding:0px;color:rgb(57,61,70);font-size:20px;font-weight:inherit;font-family:'Open Sans', sans-serif;letter-spacing:-1px;white-space:normal;border:0px;line-height:24px;vertical-align:baseline;background-color:rgb(255,255,255);">2.1添加netty依赖</h4><table width="855"><tbody style="margin:0px;padding:0px;width:auto;font:inherit;border:0px;vertical-align:baseline;"><tr class="firstRow" style="margin:0px;padding:0px;font:inherit;border:0px;vertical-align:baseline;"><td class="gutter" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(175,175,175);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">1</div><div class="line number2 index1 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">2</div><div class="line number3 index2 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">3</div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">4</div><div class="line number5 index4 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">五</div></td><td class="code" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(51,51,51);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="xml plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">&lt;</code><code class="xml keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">dependency</code><code class="xml plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">&gt;</code></div><div class="line number2 index1 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="xml spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="xml plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">&lt;</code><code class="xml keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">groupId</code><code class="xml plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">&gt;io.netty&lt;/</code><code class="xml keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">groupId</code><code class="xml plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">&gt;</code></div><div class="line number3 index2 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="xml spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="xml plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">&lt;</code><code class="xml keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">artifactId</code><code class="xml plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">&gt;netty-all&lt;/</code><code class="xml keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">artifactId</code><code class="xml plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">&gt;</code></div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="xml spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="xml plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">&lt;</code><code class="xml keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">version</code><code class="xml plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">&gt;4.0.34.Final&lt;/</code><code class="xml keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">version</code><code class="xml plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">&gt;</code></div><div class="line number5 index4 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="xml plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">&lt;/</code><code class="xml keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">dependency</code><code class="xml plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">&gt;</code></div></td></tr></tbody></table><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">如果使用maven，则将netty添加到pom.xml。</p><h4 style="margin:0px 0px 12px;padding:0px;color:rgb(57,61,70);font-size:20px;font-weight:inherit;font-family:'Open Sans', sans-serif;letter-spacing:-1px;white-space:normal;border:0px;line-height:24px;vertical-align:baseline;background-color:rgb(255,255,255);">2.2定义公共类</h4><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">服务器和客户端都使用了3个类。&nbsp;发送和接收的POJO类&nbsp;&nbsp;<span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;">LoopBackTimeStamp.java</span>，编码器类&nbsp;&nbsp;<span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;">TimeStampEncoder.java</span>&nbsp;&nbsp;和解码器类&nbsp;&nbsp;<span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;">TimeStampDecoder.java&nbsp;</span></p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">首先是LoopBackTimeStamp.java</p><table width="855"><tbody style="margin:0px;padding:0px;width:auto;font:inherit;border:0px;vertical-align:baseline;"><tr class="firstRow" style="margin:0px;padding:0px;font:inherit;border:0px;vertical-align:baseline;"><td class="gutter" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(175,175,175);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">1</div><div class="line number2 index1 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">2</div><div class="line number3 index2 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">3</div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">4</div><div class="line number5 index4 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">五</div><div class="line number6 index5 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">6</div><div class="line number7 index6 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">7</div><div class="line number8 index7 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">8</div><div class="line number9 index8 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">9</div><div class="line number10 index9 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">10</div><div class="line number11 index10 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">11</div><div class="line number12 index11 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">12</div><div class="line number13 index12 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">13</div><div class="line number14 index13 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">14</div><div class="line number15 index14 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">15</div><div class="line number16 index15 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">16</div><div class="line number17 index16 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">17</div><div class="line number18 index17 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">18</div><div class="line number19 index18 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">19</div><div class="line number20 index19 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">20</div><div class="line number21 index20 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">21</div><div class="line number22 index21 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">22</div><div class="line number23 index22 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">23</div><div class="line number24 index23 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">24</div><div class="line number25 index24 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">25</div><div class="line number26 index25 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">26</div><div class="line number27 index26 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">27</div><div class="line number28 index27 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">28</div><div class="line number29 index28 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">29</div><div class="line number30 index29 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">三十</div><div class="line number31 index30 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">31</div><div class="line number32 index31 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">32</div><div class="line number33 index32 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">33</div><div class="line number34 index33 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">34</div><div class="line number35 index34 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">35</div><div class="line number36 index35 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">36</div><div class="line number37 index36 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">37</div><div class="line number38 index37 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">38</div><div class="line number39 index38 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">39</div><div class="line number40 index39 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">40</div><div class="line number41 index40 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">41</div><div class="line number42 index41 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">42</div><div class="line number43 index42 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">43</div><div class="line number44 index43 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">44</div><div class="line number45 index44 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">45</div><div class="line number46 index45 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">46</div><div class="line number47 index46 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">47</div><div class="line number48 index47 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">48</div><div class="line number49 index48 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">49</div><div class="line number50 index49 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">50</div><div class="line number51 index50 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">51</div><div class="line number52 index51 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">52</div><div class="line number53 index52 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">53</div><div class="line number54 index53 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">54</div><div class="line number55 index54 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">55</div><div class="line number56 index55 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">56</div><div class="line number57 index56 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">57</div><div class="line number58 index57 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">58</div></td><td class="code" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(51,51,51);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">package</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">com.shengwang.demo;</code></div>&nbsp;<div class="line number3 index2 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">java.nio.ByteBuffer;</code></div>&nbsp;<div class="line number5 index4 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">class</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">LoopBackTimeStamp {</code></div><div class="line number6 index5 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">private</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">long</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">sendTimeStamp;</code></div><div class="line number7 index6 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">private</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">long</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">recvTimeStamp;</code></div>&nbsp;<div class="line number9 index8 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">LoopBackTimeStamp() {</code></div><div class="line number10 index9 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">this</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">.sendTimeStamp = System.nanoTime();</code></div><div class="line number11 index10 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div>&nbsp;<div class="line number13 index12 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">long</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">timeLapseInNanoSecond() {</code></div><div class="line number14 index13 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">return</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">recvTimeStamp - sendTimeStamp;</code></div><div class="line number15 index14 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div>&nbsp;<div class="line number17 index16 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java preprocessor" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">/**</code></div><div class="line number18 index17 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;</code><code class="java preprocessor" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">* Transfer 2 long number to a 16 byte-long byte[], every 8 bytes represent a long number.</code></div><div class="line number19 index18 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;</code><code class="java preprocessor" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">* @return</code></div><div class="line number20 index19 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;</code><code class="java preprocessor" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">*/</code></div><div class="line number21 index20 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">byte</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">[] toByteArray() {</code></div>&nbsp;<div class="line number23 index22 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">final</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">int</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">byteOfLong = Long.SIZE / Byte.SIZE;</code></div><div class="line number24 index23 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">byte</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">[] ba =&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">byte</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">[byteOfLong *&nbsp;</code><code class="java value" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,153,0);">2</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">];</code></div><div class="line number25 index24 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">byte</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">[] t1 = ByteBuffer.allocate(byteOfLong).putLong(sendTimeStamp).array();</code></div><div class="line number26 index25 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">byte</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">[] t2 = ByteBuffer.allocate(byteOfLong).putLong(recvTimeStamp).array();</code></div>&nbsp;<div class="line number28 index27 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">for</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">(</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">int</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">i =&nbsp;</code><code class="java value" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,153,0);">0</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">; i &lt; byteOfLong; i++) {</code></div><div class="line number29 index28 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ba[i] = t1[i];</code></div><div class="line number30 index29 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div>&nbsp;<div class="line number32 index31 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">for</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">(</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">int</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">i =&nbsp;</code><code class="java value" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,153,0);">0</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">; i &lt; byteOfLong; i++) {</code></div><div class="line number33 index32 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ba[i + byteOfLong] = t2[i];</code></div><div class="line number34 index33 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div><div class="line number35 index34 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">return</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ba;</code></div><div class="line number36 index35 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div>&nbsp;<div class="line number38 index37 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java preprocessor" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">/**</code></div><div class="line number39 index38 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;</code><code class="java preprocessor" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">* Transfer a 16 byte-long byte[] to 2 long numbers, every 8 bytes represent a long number.</code></div><div class="line number40 index39 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;</code><code class="java preprocessor" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">* @param content</code></div><div class="line number41 index40 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;</code><code class="java preprocessor" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">*/</code></div><div class="line number42 index41 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">void</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">fromByteArray(</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">byte</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">[] content) {</code></div><div class="line number43 index42 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">int</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">len = content.length;</code></div><div class="line number44 index43 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">final</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">int</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">byteOfLong = Long.SIZE / Byte.SIZE;</code></div><div class="line number45 index44 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">if</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">(len != byteOfLong *&nbsp;</code><code class="java value" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,153,0);">2</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">) {</code></div><div class="line number46 index45 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">System.out.println(</code><code class="java string" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,255);">"Error on content length"</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">);</code></div><div class="line number47 index46 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">return</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">;</code></div><div class="line number48 index47 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div><div class="line number49 index48 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ByteBuffer buf1 = ByteBuffer.allocate(byteOfLong).put(content,&nbsp;</code><code class="java value" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,153,0);">0</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">, byteOfLong);</code></div><div class="line number50 index49 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ByteBuffer buf2 = ByteBuffer.allocate(byteOfLong).put(content, byteOfLong, byteOfLong);</code></div><div class="line number51 index50 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">buf1.rewind();</code></div><div class="line number52 index51 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">buf2.rewind();</code></div><div class="line number53 index52 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">this</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">.sendTimeStamp = buf1.getLong();</code></div><div class="line number54 index53 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">this</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">.recvTimeStamp = buf2.getLong();</code></div><div class="line number55 index54 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code>&nbsp;<div class="line number57 index56 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">// getter/setter ignored</code></div><div class="line number58 index57 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div></td></tr></tbody></table><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">该&nbsp;&nbsp;<em style="margin:0px;padding:0px;font-family:georgia;font-size:inherit;border:0px;font-variant:inherit;font-weight:inherit;line-height:inherit;vertical-align:baseline;">LoopBackTimeStamp</em>&nbsp;&nbsp;类有2个长的数字。它还有2个方法，&nbsp;&nbsp;<em style="margin:0px;padding:0px;font-family:georgia;font-size:inherit;border:0px;font-variant:inherit;font-weight:inherit;line-height:inherit;vertical-align:baseline;">toByteArray（）</em>&nbsp;&nbsp;用于将内部2长数转换为16字节的字节数组。&nbsp;<em style="margin:0px;padding:0px;font-family:georgia;font-size:inherit;border:0px;font-variant:inherit;font-weight:inherit;line-height:inherit;vertical-align:baseline;">fromByteArray（）</em>&nbsp;&nbsp;反向工作，将16字节数组更改回2个长数字。</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">然后是编码器和解码器。编码器&nbsp;&nbsp;<span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;">TimeStampEncoder</span>&nbsp;&nbsp;将LoopBackTimeStamp对象传输到可以发送出去的字节数组中。&nbsp;</p><table width="855"><tbody style="margin:0px;padding:0px;width:auto;font:inherit;border:0px;vertical-align:baseline;"><tr class="firstRow" style="margin:0px;padding:0px;font:inherit;border:0px;vertical-align:baseline;"><td class="gutter" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(175,175,175);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">1</div><div class="line number2 index1 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">2</div><div class="line number3 index2 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">3</div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">4</div><div class="line number5 index4 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">五</div><div class="line number6 index5 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">6</div><div class="line number7 index6 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">7</div><div class="line number8 index7 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">8</div><div class="line number9 index8 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">9</div><div class="line number10 index9 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">10</div><div class="line number11 index10 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">11</div><div class="line number12 index11 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">12</div><div class="line number13 index12 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">13</div><div class="line number14 index13 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">14</div></td><td class="code" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(51,51,51);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">package</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">com.shengwang.demo.codec;</code></div>&nbsp;<div class="line number3 index2 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.buffer.ByteBuf;</code></div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.ChannelHandlerContext;</code></div><div class="line number5 index4 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.handler.codec.MessageToByteEncoder;</code></div>&nbsp;<div class="line number7 index6 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">com.shengwang.demo.LoopBackTimeStamp;</code></div>&nbsp;<div class="line number9 index8 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">class</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">TimeStampEncoder&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">extends</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">MessageToByteEncoder&lt;LoopBackTimeStamp&gt; {</code></div><div class="line number10 index9 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java color1" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">@Override</code></div><div class="line number11 index10 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">protected</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">void</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">encode(ChannelHandlerContext ctx, LoopBackTimeStamp msg, ByteBuf out)&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">throws</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">Exception {</code></div><div class="line number12 index11 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">out.writeBytes(msg.toByteArray());</code></div><div class="line number13 index12 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div><div class="line number14 index13 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div></td></tr></tbody></table><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">解码器将从套接字接收的字节传输到&nbsp;&nbsp;<span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;">LoopBackTimeStamp</span>&nbsp;&nbsp;对象，以便业务处理程序进行处理。</p><table width="855"><tbody style="margin:0px;padding:0px;width:auto;font:inherit;border:0px;vertical-align:baseline;"><tr class="firstRow" style="margin:0px;padding:0px;font:inherit;border:0px;vertical-align:baseline;"><td class="gutter" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(175,175,175);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">1</div><div class="line number2 index1 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">2</div><div class="line number3 index2 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">3</div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">4</div><div class="line number5 index4 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">五</div><div class="line number6 index5 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">6</div><div class="line number7 index6 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">7</div><div class="line number8 index7 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">8</div><div class="line number9 index8 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">9</div><div class="line number10 index9 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">10</div><div class="line number11 index10 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">11</div><div class="line number12 index11 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">12</div><div class="line number13 index12 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">13</div><div class="line number14 index13 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">14</div><div class="line number15 index14 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">15</div><div class="line number16 index15 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">16</div><div class="line number17 index16 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">17</div><div class="line number18 index17 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">18</div><div class="line number19 index18 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">19</div><div class="line number20 index19 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">20</div><div class="line number21 index20 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">21</div><div class="line number22 index21 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">22</div><div class="line number23 index22 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">23</div><div class="line number24 index23 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">24</div><div class="line number25 index24 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">25</div><div class="line number26 index25 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">26</div></td><td class="code" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(51,51,51);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">package</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">com.shengwang.demo.codec;</code></div>&nbsp;<div class="line number3 index2 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.buffer.ByteBuf;</code></div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.ChannelHandlerContext;</code></div><div class="line number5 index4 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.handler.codec.ByteToMessageDecoder;</code></div>&nbsp;<div class="line number7 index6 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">java.util.List;</code></div>&nbsp;<div class="line number9 index8 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">com.shengwang.demo.LoopBackTimeStamp;</code></div>&nbsp;<div class="line number11 index10 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">class</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">TimeStampDecoder&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">extends</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ByteToMessageDecoder {</code></div>&nbsp;<div class="line number13 index12 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java color1" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">@Override</code></div><div class="line number14 index13 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">protected</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">void</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">decode(ChannelHandlerContext ctx, ByteBuf in, List&lt;Object&gt; out)&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">throws</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">Exception {</code></div><div class="line number15 index14 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">final</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">int</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">messageLength = Long.SIZE/Byte.SIZE *</code><code class="java value" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,153,0);">2</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">;</code></div><div class="line number16 index15 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">if</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">(in.readableBytes() &lt; messageLength) {</code></div><div class="line number17 index16 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">return</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">;</code></div><div class="line number18 index17 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<div class="line number20 index19 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">byte</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">[] ba =&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">byte</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">[messageLength];</code></div><div class="line number21 index20 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">in.readBytes(ba,&nbsp;</code><code class="java value" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,153,0);">0</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">, messageLength);&nbsp;&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">// block until read 16 bytes from sockets</code></div><div class="line number22 index21 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">LoopBackTimeStamp loopBackTimeStamp =&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">LoopBackTimeStamp();</code></div><div class="line number23 index22 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">loopBackTimeStamp.fromByteArray(ba);</code></div><div class="line number24 index23 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">out.add(loopBackTimeStamp);</code></div><div class="line number25 index24 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div><div class="line number26 index25 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div></td></tr></tbody></table><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">解码器尝试整个读取16个字节，然后从这个16字节的数组中创建一个LoopBackTimeStamp对象。如果收到的字节少于16个字节，则会阻塞，直到收到完整的帧。</p><h4 style="margin:0px 0px 12px;padding:0px;color:rgb(57,61,70);font-size:20px;font-weight:inherit;font-family:'Open Sans', sans-serif;letter-spacing:-1px;white-space:normal;border:0px;line-height:24px;vertical-align:baseline;background-color:rgb(255,255,255);">2.3定义服务器类</h4><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">除了上面3个常用类之外，服务器和客户端都分别有2个自己的类，Main +一个用于实际逻辑的Handler。服务器ServerHandler.java的逻辑处理程序如下所示。</p><table width="855"><tbody style="margin:0px;padding:0px;width:auto;font:inherit;border:0px;vertical-align:baseline;"><tr class="firstRow" style="margin:0px;padding:0px;font:inherit;border:0px;vertical-align:baseline;"><td class="gutter" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(175,175,175);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">1</div><div class="line number2 index1 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">2</div><div class="line number3 index2 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">3</div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">4</div><div class="line number5 index4 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">五</div><div class="line number6 index5 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">6</div><div class="line number7 index6 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">7</div><div class="line number8 index7 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">8</div><div class="line number9 index8 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">9</div><div class="line number10 index9 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">10</div><div class="line number11 index10 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">11</div><div class="line number12 index11 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">12</div><div class="line number13 index12 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">13</div><div class="line number14 index13 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">14</div><div class="line number15 index14 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">15</div><div class="line number16 index15 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">16</div><div class="line number17 index16 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">17</div><div class="line number18 index17 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">18</div><div class="line number19 index18 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">19</div><div class="line number20 index19 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">20</div><div class="line number21 index20 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">21</div><div class="line number22 index21 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">22</div><div class="line number23 index22 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">23</div><div class="line number24 index23 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">24</div><div class="line number25 index24 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">25</div><div class="line number26 index25 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">26</div><div class="line number27 index26 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">27</div><div class="line number28 index27 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">28</div><div class="line number29 index28 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">29</div><div class="line number30 index29 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">三十</div><div class="line number31 index30 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">31</div><div class="line number32 index31 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">32</div><div class="line number33 index32 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">33</div><div class="line number34 index33 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">34</div></td><td class="code" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(51,51,51);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">package</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">com.shengwang.demo;</code></div>&nbsp;<div class="line number3 index2 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.ChannelHandlerContext;</code></div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.ChannelInboundHandlerAdapter;</code></div><div class="line number5 index4 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.handler.timeout.IdleState;</code></div><div class="line number6 index5 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.handler.timeout.IdleStateEvent;</code></div>&nbsp;<div class="line number8 index7 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">class</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ServerHandler&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">extends</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ChannelInboundHandlerAdapter {</code></div>&nbsp;<div class="line number10 index9 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java color1" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">@Override</code></div><div class="line number11 index10 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">void</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">channelRead(ChannelHandlerContext ctx, Object msg)&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">throws</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">Exception {</code></div><div class="line number12 index11 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">LoopBackTimeStamp ts = (LoopBackTimeStamp) msg;</code></div><div class="line number13 index12 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ts.setRecvTimeStamp(System.nanoTime());</code></div><div class="line number14 index13 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">System.out.println(</code><code class="java string" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,255);">"loop delay in ms : "</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">+&nbsp;</code><code class="java value" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,153,0);">1.0</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">* ts.timeLapseInNanoSecond() / 1000000L);</code></div><div class="line number15 index14 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div>&nbsp;<div class="line number17 index16 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">// Here is how we send out heart beat for idle to long</code></div><div class="line number18 index17 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java color1" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">@Override</code></div><div class="line number19 index18 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">void</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">userEventTriggered(ChannelHandlerContext ctx, Object evt)</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">throws</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">Exception {</code></div><div class="line number20 index19 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">if</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">(evt&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">instanceof</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">IdleStateEvent) {</code></div><div class="line number21 index20 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">IdleStateEvent event = (IdleStateEvent) evt;</code></div><div class="line number22 index21 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">if</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">(event.state() == IdleState.ALL_IDLE) {&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">// idle for no read and write</code></div><div class="line number23 index22 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ctx.writeAndFlush(</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">LoopBackTimeStamp());</code></div><div class="line number24 index23 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div><div class="line number25 index24 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div><div class="line number26 index25 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div>&nbsp;<div class="line number28 index27 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java color1" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">@Override</code></div><div class="line number29 index28 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">void</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {</code></div><div class="line number30 index29 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">// Close the connection when an exception is raised.</code></div><div class="line number31 index30 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">cause.printStackTrace();</code></div><div class="line number32 index31 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ctx.close();</code></div><div class="line number33 index32 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div><div class="line number34 index33 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div></td></tr></tbody></table><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">这三种方法都是重写方法。第一个&nbsp;&nbsp;<em style="margin:0px;padding:0px;font-family:georgia;font-size:inherit;border:0px;font-variant:inherit;font-weight:inherit;line-height:inherit;vertical-align:baseline;">channelRead（）</em>&nbsp;&nbsp;读取循环返回消息并打印出行程所花费的时间。第二种方法处理<span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;">IdleStateHandler&nbsp;</span>触发的事件&nbsp;&nbsp;（您可能需要向上滚动以查看服务器管道的配置方式）。当空闲时间过长时，&nbsp;&nbsp;<span style="margin:0px;padding:0px;font-weight:bolder;color:inherit;font-family:inherit;font-size:inherit;border:0px;font-style:inherit;font-variant:inherit;line-height:inherit;vertical-align:baseline;">LoopBackTimeStamp</span>&nbsp;&nbsp;对象将作为心跳发送出去。</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">服务器的另一个类是主类NettyServer.java。</p><table width="855"><tbody style="margin:0px;padding:0px;width:auto;font:inherit;border:0px;vertical-align:baseline;"><tr class="firstRow" style="margin:0px;padding:0px;font:inherit;border:0px;vertical-align:baseline;"><td class="gutter" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(175,175,175);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">1</div><div class="line number2 index1 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">2</div><div class="line number3 index2 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">3</div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">4</div><div class="line number5 index4 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">五</div><div class="line number6 index5 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">6</div><div class="line number7 index6 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">7</div><div class="line number8 index7 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">8</div><div class="line number9 index8 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">9</div><div class="line number10 index9 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">10</div><div class="line number11 index10 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">11</div><div class="line number12 index11 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">12</div><div class="line number13 index12 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">13</div><div class="line number14 index13 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">14</div><div class="line number15 index14 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">15</div><div class="line number16 index15 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">16</div><div class="line number17 index16 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">17</div><div class="line number18 index17 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">18</div><div class="line number19 index18 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">19</div><div class="line number20 index19 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">20</div><div class="line number21 index20 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">21</div><div class="line number22 index21 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">22</div><div class="line number23 index22 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">23</div><div class="line number24 index23 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">24</div><div class="line number25 index24 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">25</div><div class="line number26 index25 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">26</div><div class="line number27 index26 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">27</div><div class="line number28 index27 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">28</div><div class="line number29 index28 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">29</div><div class="line number30 index29 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">三十</div><div class="line number31 index30 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">31</div><div class="line number32 index31 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">32</div><div class="line number33 index32 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">33</div><div class="line number34 index33 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">34</div><div class="line number35 index34 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">35</div><div class="line number36 index35 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">36</div><div class="line number37 index36 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">37</div><div class="line number38 index37 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">38</div><div class="line number39 index38 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">39</div><div class="line number40 index39 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">40</div><div class="line number41 index40 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">41</div><div class="line number42 index41 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">42</div><div class="line number43 index42 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">43</div><div class="line number44 index43 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">44</div><div class="line number45 index44 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">45</div><div class="line number46 index45 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">46</div><div class="line number47 index46 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">47</div><div class="line number48 index47 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">48</div><div class="line number49 index48 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">49</div><div class="line number50 index49 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">50</div><div class="line number51 index50 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">51</div></td><td class="code" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(51,51,51);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">package</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">com.shengwang.demo;</code></div>&nbsp;<div class="line number3 index2 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.bootstrap.ServerBootstrap;</code></div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.ChannelInitializer;</code></div><div class="line number5 index4 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.ChannelOption;</code></div><div class="line number6 index5 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.ChannelPipeline;</code></div><div class="line number7 index6 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.nio.NioEventLoopGroup;</code></div><div class="line number8 index7 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.socket.SocketChannel;</code></div><div class="line number9 index8 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.socket.nio.NioServerSocketChannel;</code></div><div class="line number10 index9 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.handler.timeout.IdleStateHandler;</code></div><div class="line number11 index10 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.util.concurrent.DefaultEventExecutorGroup;</code></div><div class="line number12 index11 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.util.concurrent.EventExecutorGroup;</code></div><div class="line number13 index12 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">java.io.IOException;</code></div><div class="line number14 index13 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">com.shengwang.demo.codec.TimeStampDecoder;</code></div><div class="line number15 index14 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">com.shengwang.demo.codec.TimeStampEncoder;</code></div>&nbsp;<div class="line number17 index16 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">class</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">NettyServer {</code></div>&nbsp;<div class="line number19 index18 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">static</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">void</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">main(String[] args)&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">throws</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">IOException, InterruptedException {</code></div><div class="line number20 index19 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">NioEventLoopGroup boosGroup =&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">NioEventLoopGroup();</code></div><div class="line number21 index20 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">NioEventLoopGroup workerGroup =&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">NioEventLoopGroup();</code></div><div class="line number22 index21 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ServerBootstrap bootstrap =&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ServerBootstrap();</code></div><div class="line number23 index22 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">bootstrap.group(boosGroup, workerGroup);</code></div><div class="line number24 index23 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">bootstrap.channel(NioServerSocketChannel.</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">class</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">);</code></div><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<div class="line number26 index25 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">// ===========================================================</code></div><div class="line number27 index26 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">// 1. define a separate thread pool to execute handlers with</code></div><div class="line number28 index27 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">//&nbsp;&nbsp;&nbsp; slow business logic. e.g database operation</code></div><div class="line number29 index28 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">// ===========================================================</code></div><div class="line number30 index29 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">final</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">EventExecutorGroup group =&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">DefaultEventExecutorGroup(</code><code class="java value" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,153,0);">1500</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">);&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">//thread pool of 1500</code></div><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<div class="line number32 index31 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">bootstrap.childHandler(</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ChannelInitializer&lt;SocketChannel&gt;() {</code></div><div class="line number33 index32 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">@Override</code></div><div class="line number34 index33 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">protected</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">void</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">initChannel(SocketChannel ch)&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">throws</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">Exception {</code></div><div class="line number35 index34 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ChannelPipeline pipeline = ch.pipeline();</code></div><div class="line number36 index35 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">pipeline.addLast(</code><code class="java string" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,255);">"idleStateHandler"</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">,</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">IdleStateHandler(</code><code class="java value" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,153,0);">0</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">,</code><code class="java value" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,153,0);">0</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">,</code><code class="java value" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,153,0);">5</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">));&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">// add with name</code></div><div class="line number37 index36 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">pipeline.addLast(</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">TimeStampEncoder());&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">// add without name, name auto generated</code></div><div class="line number38 index37 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">pipeline.addLast(</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">TimeStampDecoder());&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">// add without name, name auto generated</code></div><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<div class="line number40 index39 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">//===========================================================</code></div><div class="line number41 index40 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">// 2. run handler with slow business logic</code></div><div class="line number42 index41 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">//&nbsp;&nbsp;&nbsp; in separate thread from I/O thread</code></div><div class="line number43 index42 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">//===========================================================</code></div><div class="line number44 index43 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">pipeline.addLast(group,</code><code class="java string" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,255);">"serverHandler"</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">,</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ServerHandler());</code></div><div class="line number45 index44 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div><div class="line number46 index45 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">});</code></div><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<div class="line number48 index47 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">bootstrap.childOption(ChannelOption.SO_KEEPALIVE,&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">true</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">);</code></div><div class="line number49 index48 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">bootstrap.bind(</code><code class="java value" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,153,0);">19000</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">).sync();</code></div><div class="line number50 index49 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div><div class="line number51 index50 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div></td></tr></tbody></table><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">大多数主要代码都是如何初始化netty服务器的样板，注意如何将thoese处理程序添加到管道以及如何在分离的线程中运行业务逻辑处理程序。</p><h4 style="margin:0px 0px 12px;padding:0px;color:rgb(57,61,70);font-size:20px;font-weight:inherit;font-family:'Open Sans', sans-serif;letter-spacing:-1px;white-space:normal;border:0px;line-height:24px;vertical-align:baseline;background-color:rgb(255,255,255);">2.4定义客户端类</h4><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">客户端和服务器一样，也有2个类。主+一个处理程序。ClientHandler类与ServerHandler类一样，也是一个“入站处理程序”，只有进程收入消息。</p><table width="855"><tbody style="margin:0px;padding:0px;width:auto;font:inherit;border:0px;vertical-align:baseline;"><tr class="firstRow" style="margin:0px;padding:0px;font:inherit;border:0px;vertical-align:baseline;"><td class="gutter" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(175,175,175);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">1</div><div class="line number2 index1 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">2</div><div class="line number3 index2 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">3</div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">4</div><div class="line number5 index4 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">五</div><div class="line number6 index5 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">6</div><div class="line number7 index6 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">7</div><div class="line number8 index7 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">8</div><div class="line number9 index8 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">9</div><div class="line number10 index9 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">10</div><div class="line number11 index10 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">11</div><div class="line number12 index11 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">12</div><div class="line number13 index12 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">13</div><div class="line number14 index13 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">14</div><div class="line number15 index14 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">15</div><div class="line number16 index15 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">16</div><div class="line number17 index16 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">17</div><div class="line number18 index17 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">18</div><div class="line number19 index18 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">19</div><div class="line number20 index19 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">20</div></td><td class="code" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(51,51,51);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">package</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">com.shengwang.demo;</code></div>&nbsp;<div class="line number3 index2 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.ChannelHandlerContext;</code></div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.ChannelInboundHandlerAdapter;</code></div>&nbsp;<div class="line number6 index5 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">class</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ClientHandler&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">extends</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ChannelInboundHandlerAdapter {</code></div>&nbsp;<div class="line number8 index7 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java color1" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">@Override</code></div><div class="line number9 index8 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">void</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">channelRead(ChannelHandlerContext ctx, Object msg)&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">throws</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">Exception {</code></div><div class="line number10 index9 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">LoopBackTimeStamp ts = (LoopBackTimeStamp) msg;</code></div><div class="line number11 index10 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ctx.writeAndFlush(ts);&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">//recieved message sent back directly</code></div><div class="line number12 index11 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div>&nbsp;<div class="line number14 index13 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java color1" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">@Override</code></div><div class="line number15 index14 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">void</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {</code></div><div class="line number16 index15 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments" style="margin:10px 0px 0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;clear:both;color:rgb(0,130,0);">// Close the connection when an exception is raised.</code></div><div class="line number17 index16 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">cause.printStackTrace();</code></div><div class="line number18 index17 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ctx.close();</code></div><div class="line number19 index18 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div><div class="line number20 index19 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div></td></tr></tbody></table><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">客户端读取消息并直接将其发回以进行环回。</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">客户端NettyClient.java的主要类如下所示。</p><table width="855"><tbody style="margin:0px;padding:0px;width:auto;font:inherit;border:0px;vertical-align:baseline;"><tr class="firstRow" style="margin:0px;padding:0px;font:inherit;border:0px;vertical-align:baseline;"><td class="gutter" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(175,175,175);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">1</div><div class="line number2 index1 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">2</div><div class="line number3 index2 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">3</div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">4</div><div class="line number5 index4 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">五</div><div class="line number6 index5 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">6</div><div class="line number7 index6 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">7</div><div class="line number8 index7 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">8</div><div class="line number9 index8 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">9</div><div class="line number10 index9 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">10</div><div class="line number11 index10 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">11</div><div class="line number12 index11 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">12</div><div class="line number13 index12 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">13</div><div class="line number14 index13 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">14</div><div class="line number15 index14 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">15</div><div class="line number16 index15 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">16</div><div class="line number17 index16 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">17</div><div class="line number18 index17 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">18</div><div class="line number19 index18 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">19</div><div class="line number20 index19 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">20</div><div class="line number21 index20 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">21</div><div class="line number22 index21 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">22</div><div class="line number23 index22 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">23</div><div class="line number24 index23 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">24</div><div class="line number25 index24 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">25</div><div class="line number26 index25 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">26</div><div class="line number27 index26 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">27</div><div class="line number28 index27 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">28</div><div class="line number29 index28 alt2" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">29</div><div class="line number30 index29 alt1" style="margin:0px;padding:0px .2em;font:inherit;border-width:0px 3px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);vertical-align:baseline;background-color:rgb(231,229,220);">三十</div></td><td class="code" style="margin:0px;padding:7px 15px;font:inherit;border-width:0px;border-color:rgb(102,102,102);color:rgb(51,51,51);vertical-align:baseline;"><div class="line number1 index0 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">package</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">com.shengwang.demo;</code></div>&nbsp;<div class="line number3 index2 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.bootstrap.Bootstrap;</code></div><div class="line number4 index3 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.ChannelInitializer;</code></div><div class="line number5 index4 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.nio.NioEventLoopGroup;</code></div><div class="line number6 index5 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.socket.SocketChannel;</code></div><div class="line number7 index6 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">io.netty.channel.socket.nio.NioSocketChannel;</code></div>&nbsp;<div class="line number9 index8 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">com.shengwang.demo.codec.TimeStampDecoder;</code></div><div class="line number10 index9 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">import</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">com.shengwang.demo.codec.TimeStampEncoder;</code></div>&nbsp;<div class="line number12 index11 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">class</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">NettyClient {</code></div>&nbsp;<div class="line number14 index13 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">static</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">void</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">main(String[] args) {</code></div><div class="line number15 index14 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">NioEventLoopGroup workerGroup =&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">NioEventLoopGroup();</code></div><div class="line number16 index15 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">Bootstrap b =&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">Bootstrap();</code></div><div class="line number17 index16 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">b.group(workerGroup);</code></div><div class="line number18 index17 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">b.channel(NioSocketChannel.</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">class</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">);</code></div>&nbsp;<div class="line number20 index19 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">b.handler(</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ChannelInitializer&lt;SocketChannel&gt;() {</code></div><div class="line number21 index20 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(128,128,128);">@Override</code></div><div class="line number22 index21 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">public</code>&nbsp;<code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">void</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">initChannel(SocketChannel ch)&nbsp;</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">throws</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">Exception {</code></div><div class="line number23 index22 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ch.pipeline().addLast(</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">TimeStampEncoder(),</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">TimeStampDecoder(),</code><code class="java keyword" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;font-weight:bold;color:rgb(0,102,153);">new</code>&nbsp;<code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">ClientHandler());</code></div><div class="line number24 index23 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div><div class="line number25 index24 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">});</code></div><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<div class="line number27 index26 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">String serverIp =&nbsp;</code><code class="java string" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,255);">"192.168.203.156"</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">;</code></div><div class="line number28 index27 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">b.connect(serverIp,&nbsp;</code><code class="java value" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,153,0);">19000</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">);</code></div><div class="line number29 index28 alt2" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java spaces" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;">&nbsp;&nbsp;</code><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div><div class="line number30 index29 alt1" style="margin:0px;padding:0px .3em;font:inherit;border:0px;vertical-align:baseline;"><code class="java plain" style="margin:0px;padding:0px 8px;font-family:monospace, consolas, sans-serif;font-size:inherit;border:0px;font-variant:inherit;line-height:1.5;vertical-align:baseline;color:rgb(0,0,0);">}</code></div></td></tr></tbody></table><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">演示客户端连接到硬代码ip和端口。&nbsp;&nbsp;</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">最后，项目层次结构如下：</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);"><a rel="nofollow" href="https://lh3.googleusercontent.com/-pSXG4yXZukI/VvOo-n6wr8I/AAAAAAAAA5w/ybHDJvEnG5Q/s1600-h/image%25255B3%25255D.png" style="margin:0px;padding:0px;background-color:transparent;color:rgb(82,111,148);font:inherit;border:0px;vertical-align:baseline;"><img src="https://bbs-img.huaweicloud.com/blogs/img/1561273281624270.png" title="1561273281624270.png" alt="image_thumb [1] .PNG" class="localImage"></a></p><h3 style="margin:0px 0px 12px;padding:0px;color:rgb(57,61,70);font-size:22px;font-family:'Open Sans', sans-serif;letter-spacing:-1px;white-space:normal;border:0px;line-height:38px;vertical-align:baseline;background-color:rgb(255,255,255);">3.运行它</h3><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">首先让我们运行服务器，然后打开另一个窗口来运行客户端。连接客户端后，每隔5秒钟会看到一个回送行程消息在屏幕上打印出来。</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);"><a rel="nofollow" href="https://lh3.googleusercontent.com/-OV_zNVSVZKI/VvOo_1LyfwI/AAAAAAAAA54/2JJ7Bxg1hMc/s1600-h/image%25255B6%25255D.png" style="margin:0px;padding:0px;background-color:transparent;color:rgb(82,111,148);font:inherit;border:0px;vertical-align:baseline;"><img src="https://bbs-img.huaweicloud.com/blogs/img/1561273286488613.png" title="1561273286488613.png" alt="image_thumb [2] .PNG" class="localImage"></a></p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">此外，该演示还用于粗略估计我们项目中的硬件需求，以支持服务器支持大型长连接客户端。在具有2个CPU（Xeon E5-2650 2.0GHZ，20M高速缓存，8个内核，16个线程）和32G RAM的服务器上运行NettyServer时。工作负载如下所示，有264,000个连接。</p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);"><a rel="nofollow" href="https://lh3.googleusercontent.com/-tGY4RJ0zPNs/VvSvvoKpNBI/AAAAAAAAA6Q/D9NHR3gyXr4/s1600-h/image%25255B3%25255D.png" style="margin:0px;padding:0px;background-color:transparent;color:rgb(82,111,148);font:inherit;border:0px;vertical-align:baseline;"><img src="https://bbs-img.huaweicloud.com/blogs/img/1561273291139197.png" title="1561273291139197.png" alt="image_thumb [1]（1）.png" class="localImage"></a></p><p style="margin-top:0px;margin-bottom:20px;padding:0px;color:rgb(34,34,34);font-size:14px;font-family:'PT Serif', arial, sans-serif;white-space:normal;line-height:inherit;border:0px;vertical-align:baseline;background-color:rgb(255,255,255);">6台主机用作运行NettyClient的客户端。所以每个主机都有大约40,000个连接。同一客户端主机上的连接同时触发心跳，因此cpu使用大致会减少此工作负载。如果心跳可以分散一点，cpu工作量就会明显下降。</p><p><br></p>
    </div>
    
    
    <p class="pc_current ask-tip">登录后可下载附件，请<a href="https://auth.huaweicloud.com/authui/login?service=https://bbs.huaweicloud.com/blogs/115090#attachment&amp;locale=zh-cn">登录</a>或者<a href="https://reg.huaweicloud.com/registerui/public/custom/register.html?locale=zh-cn&amp;service=https://bbs.huaweicloud.com#/register">注册</a></p>

    <!-- 版权声明 start -->
    
    
    
    <!-- 版权声明 end -->

    <div class="blog-menu-footer m-blog-menu-footer-bottom">
        
    </div>
</div></div>